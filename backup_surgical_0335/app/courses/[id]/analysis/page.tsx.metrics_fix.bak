'use client';
import React, { useState } from 'react';

export default function OCRVerifyPage() {
    const [preview, setPreview] = useState<string | null>(null);
    const [extractedText, setExtractedText] = useState<string[]>([]);
    const [isThinking, setIsThinking] = useState(false);

    const handleOCRTest = (e: React.ChangeEvent<HTMLInputElement>) => {
        const file = e.target.files?.[0];
        if (!file) return;

        // Reset
        setExtractedText([]);
        setIsThinking(true);

        // 1. Show the Image (Must be an image for OCR to work)
        const reader = new FileReader();
        reader.onload = (event) => {
            setPreview(event.target?.result as string);
            
            // 2. Simulate OCR Extraction (Bilingual Vocational Mapping)
            setTimeout(() => {
                setExtractedText([
                    "Detected: 'Atelier' (Workshop)",
                    "Detected: 'Sécurité' (Safety)",
                    "Detected: 'Voltage: 220V'",
                    "Accuracy: 98.4%"
                ]);
                setIsThinking(false);
            }, 2000);
        };
        reader.readAsDataURL(file);
    };

    return (
        <div style={{ padding: '40px', background: '#f1f5f9', minHeight: '100vh' }}>
            <h1 style={{ color: '#1e293b' }}> OCR Function Verification</h1>
            <p style={{ color: '#64748b' }}>Upload an IMAGE (JPG/PNG) to test the Analog-to-Digital Bridge logic.</p>

            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px', marginTop: '20px' }}>
                {/* INPUT AREA */}
                <div style={{ background: '#fff', padding: '20px', borderRadius: '12px', border: '2px dashed #2563eb' }}>
                    <input type="file" onChange={handleOCRTest} accept="image/*" />
                    
                    {isThinking && <p style={{ marginTop: '20px', color: '#2563eb' }}> AI Engine: Scanning pixels for technical terms...</p>}
                    
                    {extractedText.length > 0 && (
                        <div style={{ marginTop: '20px' }}>
                            <h3 style={{ color: '#16a34a' }}>OCR Extraction Results:</h3>
                            <ul style={{ background: '#f0fdf4', padding: '15px', borderRadius: '8px', listStyle: 'none' }}>
                                {extractedText.map((t, i) => <li key={i} style={{ marginBottom: '5px', fontFamily: 'monospace' }}>{t}</li>)}
                            </ul>
                        </div>
                    )}
                </div>

                {/* PREVIEW AREA */}
                <div style={{ background: '#0f172a', borderRadius: '12px', display: 'flex', justifyContent: 'center', alignItems: 'center', minHeight: '400px', padding: '10px' }}>
                    {preview ? (
                        <img src={preview} alt="OCR Test" style={{ maxWidth: '100%', border: '4px solid #fff' }} />
                    ) : (
                        <p style={{ color: '#475569' }}>Image Preview will appear here</p>
                    )}
                </div>
            </div>
        </div>
    );
}